<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="{{url('templates/assets/img/gerais/favicon.png')}}" type="image/x-icon">
    <title>Nova Senha</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light d-flex justify-content-center align-items-center vh-100">

    <div class="card p-4 shadow" style="width: 22rem;">
        {{ flash() }}
        <form action="{{url('password-recovery')}}" method="post">
            <input type="hidden" name="_method" value="PATCH">
            <div class="pb-3">
                <li>8 caracteres não sequenciais</li>
                <li>1 letra maiúscula</li>
                <li>1 simbolo (!@#$%^&*()_+{}[]<>? etc.)</li>
            </div>
            <input hidden type="text" value="{{ token }}" name="token">
            <div class="mb-3">
                <label for="password1" class="form-label fw-bold">Nova senha</label>
                <input required type="password" class="form-control" id="password1" name="password1"
                    placeholder="Digite sua nova senha">
            </div>
            <div class="mb-3">
                <label for="password2" class="form-label fw-bold">Confirmar senha</label>
                <input required type="password" class="form-control" id="password2" name="password2"
                    placeholder="Confirme sua nova senha">
            </div>
            <button type="submit"
                style="background:#3FBC9A;color:#ffffff;border:none;padding:12px 24px;border-radius:6px;font-size:15px;font-weight:600;cursor:pointer;width: 100%;">
                Salvar
            </button>
            <span class="text-danger" id="mensagem"></span>

        </form>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(document).ready(function () {
            $("form").on("submit", function (event) {
                let password = $("#password1").val();
                let confirmPassword = $("#password2").val();
                let message = $("#message");

                message.text("");

                if (password.length < 8) {
                    message.text("A senha deve ter no mínimo 8 caracteres.");
                    event.preventDefault();
                    return;
                }

                if (password !== confirmPassword) {
                    message.text("As senhas não coincidem.");
                    event.preventDefault();
                    return;
                }

                if (isSequential(password)) {
                    message.text("A senha não pode ser uma sequência simples.");
                    event.preventDefault();
                    return;
                }

                if (!hasUppercase(password)) {
                    message.text("A senha deve conter pelo menos uma letra maiúscula.");
                    event.preventDefault();
                    return;
                }

                if (!hasSymbol(password)) {
                    message.text("A senha deve conter pelo menos um símbolo especial.");
                    event.preventDefault();
                    return;
                }
            });

            function isSequential(password) {
                let sequences = ["12345678", "abcdefgh", "87654321", "qwertyui"];
                return sequences.some(seq => password.includes(seq));
            }

            function hasUppercase(password) {
                return /[A-Z]/.test(password);
            }

            function hasSymbol(password) {
                return /[!@#$%^&*()_+{}\[\]:;<>,.?~\\-]/.test(password);
            }
        });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>