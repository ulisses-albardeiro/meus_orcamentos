{% extends 'base.html' %}

{% block conteudo %}

<style>
    .botao {
        background-color: #373643;
    }

    .botao:hover {
        background-color: #373643e7 !important;

    }
</style>

<h3 class="text-center">Confira Seus Dados</h3>
<p style="margin-top: -15px;" class="text-danger text-center">Para uma configuração persistente dos seus dados ou para
    adicionar logo ao seu orçamento, vá para
    <a href="{{ url('empresa') }}">Perfil da Empresa</a>
</p>
<form action="{{ url('orcamento/cadastrar/' ~ modelo)}}" method="post" target="_blank">

    {% include '/componentes/cabecalho-dados-empresa.html' %}

    <h3 class="text-center mt-4">Dados do cliente</h3>
    <p style="margin-top: -15px;" class="text-danger text-center">Campos com * são obrigatórios</p>

    {% include '/componentes/cabecalho-dados-cliente.html' %}
    
    <h3 class="mt-4 text-center">Itens do Orçamento</h3>
    <p style="margin-top: -15px;" class="text-danger text-center">Campos com * são obrigatórios</p>
    <div class="card border-1 shadow-lg p-3">
        <div id="itens-container" class="mb-3">
            <div class="row g-2 item">
                <div class="col-7">
                    <input required type="text" class="form-control form-control-sm" placeholder="Nome do Serviço*"
                        name="itens[0][nome]">
                </div>
                <div class="col-2">
                    <input required type="number" class="form-control form-control-sm" placeholder="Qtd*"
                        name="itens[0][qtd]">
                </div>
                <div class="col-3">
                    <input required type="text" class="form-control form-control-sm valor-unitario"
                        placeholder="Valor unitário*" name="itens[0][valor]" id="valor-unitario">
                </div>

                <div class="col-12">
                    <textarea class="form-control form-control-sm" placeholder="Descrição"
                        name="itens[0][descricao]"></textarea>
                </div>
            </div>
        </div>
        <button style="background-color: #0b5ed7;" type="button" class="btn btn-sm btn-primary mb-3" onclick="adicionarItemDetalhado()">Adicionar
            Item</button>
    </div>

    <h3 class="mt-4 text-center">Detalhes finais</h3>

    <div class="card border-1 shadow-lg p-3">
        <div class="mb-3 d-flex justify-content-center">
            <div class="col-md-2">
                <label class="form-label">Validade do orçamento</label>
                <input type="date" class="form-control form-control-sm" name="validade-orcamento">
            </div>
        </div>

        <div class="mb-3">
            <label class="form-label">Anotações sobre o Orçamento</label>
            <textarea class="form-control form-control-sm" placeholder="Coloque prazos, formas de pagamento e outras informações relevantes para seu orçamento" name="anotacoes"></textarea>
        </div>
    </div>

    <div class="text-center my-4">
        <button type="submit" class="btn botao text-white"><i style="color: #18cb96;"
                class="bi bi-plus-circle"></i> Gerar Orçamento</button>
    </div>
</form>

<script src="{{url('templates/assets/js/orcamentos.js')}}?v=1.0.2"></script>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Função para adicionar novos itens ao orçamento
        adicionarItemDetalhado();
        mascaraCpfCnpjInput(document.getElementById('cpf_cnpj_cliente'));
        mascaraCepInput(document.getElementById('cep_cliente'));
        mascaraTelefoneInput(document.getElementById('telefone_cliente'));
        mascaraCelularInput(document.getElementById('celular_cliente'));

        // Aplica máscara monetária ao campo inicial
        const camposValor = document.querySelectorAll('.valor-unitario');
        camposValor.forEach(campo => {
            aplicarMascaraMonetaria(campo);
        });
       
    });
</script>

{% endblock %}