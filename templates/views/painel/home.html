{% extends 'base.html' %}
{% block conteudo %}

<style>
    h5 {
        font-weight: 600;
        margin-top: 2rem;
        margin-bottom: 1rem;
        color: #373643;
        font-family: 'Plus Jakarta Sans', sans-serif;
    }

    .container {
        margin-top: -30px;
    }

    .card.bg-card {
        background-color: #22CC9B;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        border-radius: 1rem;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
    }

    .card.bg-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
    }

    .card i {
        min-width: 40px;
    }

    @media (max-width: 576px) {
        .card h6 {
            font-size: 14px;
        }

        .card .badge {
            font-size: 11px;
        }

        h5 {
            font-size: 16px;
        }
    }
</style>

<div class="container mb-4 font">
    <div class="mt-5">{{ flash() }}</div>

    <div class="row g-4">
        <div class="col-12 col-md-6">
            <h5 class="mb-3 mt-4 d-flex align-items-center gap-2">
                <i class="bi bi-person-circle"></i> Perfil
            </h5>
            <div class="row g-3">
                <div class="col-12 col-md-12 col-xl-12">
                    <a href="{{ url('perfil') }}" class="text-decoration-none">
                        <div class="card bg-card border-0 h-100">
                            <div class="card-body d-flex align-items-center gap-3">
                                <i class="bi bi-person-circle fs-1 text-white"></i>
                                <div>
                                    <h6 class="mb-1 text-dark">Seu Perfil</h6>
                                    <span class="badge bg-dark text-white small">Editar Informações</span>
                                </div>
                            </div>
                        </div>
                    </a>
                </div>
            </div>
        </div>

        <div class="col-12 col-md-6">
            <h5 class="mb-3 mt-4 d-flex align-items-center gap-2">
                <i class="bi bi-cash-coin"></i> Finanças
            </h5>
            <div class="row g-3">
                <div class="col-12 col-md-12 col-xl-12">
                    <a href="{{ url('dashboard-financas') }}" class="text-decoration-none">
                        <div class="card bg-card border-0 h-100">
                            <div class="card-body d-flex align-items-center gap-3">
                                <i class="bi bi-cash-coin fs-1 text-white"></i>
                                <div>
                                    <h6 class="mb-1 text-dark">Gestão Financeira</h6>
                                    <span class="badge bg-dark text-white small">Gerenciar Finanças</span>
                                </div>
                            </div>
                        </div>
                    </a>
                </div>
            </div>
        </div>
    </div>


    <h5 class="mb-3 mt-3 d-flex align-items-center gap-2">
        <i class="bi bi-file-earmark-text"></i> Documentos
    </h5>
    <div class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-3">

        <div class="col">
            <a href="{{ url('orcamento/listar') }}" class="text-decoration-none">
                <div class="card bg-card border-0 h-100">
                    <div class="card-body d-flex align-items-center gap-3">
                        <i class="bi bi-folder2-open fs-1 text-white"></i>
                        <div>
                            <h6 class="mb-1 text-dark">Ver Orçamentos</h6>
                            <span class="badge bg-dark text-white small">Veja Seus Orçamentos</span>
                        </div>
                    </div>
                </div>
            </a>
        </div>
        <div class="col">
            <a href="{{ url('orcamento/modelos') }}" class="text-decoration-none">
                <div class="card bg-card border-0 h-100">
                    <div class="card-body d-flex align-items-center gap-3">
                        <i class="bi bi-file-earmark-plus fs-1 text-white"></i>
                        <div>
                            <h6 class="mb-1 text-dark">Criar Orçamento</h6>
                            <span class="badge bg-dark text-white small">Crie um Novo Orçamento</span>
                        </div>
                    </div>
                </div>
            </a>
        </div>
        <div class="col">
            <a href="{{ url('minhas-listas') }}" class="text-decoration-none">
                <div class="card bg-card border-0 h-100">
                    <div class="card-body d-flex align-items-center gap-3">
                        <i class="bi bi-card-checklist fs-1 text-white"></i>
                        <div>
                            <h6 class="mb-1 text-dark">Ver Listas</h6>
                            <span class="badge bg-dark text-white small">Veja Suas Listas</span>
                        </div>
                    </div>
                </div>
            </a>
        </div>
        <div class="col">
            <a href="{{ url('criar-lista') }}" class="text-decoration-none">
                <div class="card bg-card border-0 h-100">
                    <div class="card-body d-flex align-items-center gap-3">
                        <i class="bi bi-plus-square fs-1 text-white"></i>
                        <div>
                            <h6 class="mb-1 text-dark">Criar Lista</h6>
                            <span class="badge bg-dark text-white small">Crie uma Nova Lista</span>
                        </div>
                    </div>
                </div>
            </a>
        </div>
        <div class="col">
            <a href="{{ url('recibo/listar') }}" class="text-decoration-none">
                <div class="card bg-card border-0 h-100">
                    <div class="card-body d-flex align-items-center gap-3">
                        <i class="bi bi-list-task fs-1 text-white"></i>
                        <div>
                            <h6 class="mb-1 text-dark">Ver Recibos</h6>
                            <span class="badge bg-dark text-white small">Veja Seus Recibos</span>
                        </div>
                    </div>
                </div>
            </a>
        </div>
        <div class="col">
            <a href="{{ url('recibo/criar') }}" class="text-decoration-none">
                <div class="card bg-card border-0 h-100">
                    <div class="card-body d-flex align-items-center gap-3">
                        <i class="bi bi-check2-square fs-1 text-white"></i>
                        <div>
                            <h6 class="mb-1 text-dark">Criar Recibo</h6>
                            <span class="badge bg-dark text-white small">Crie um Novo Recibo</span>
                        </div>
                    </div>
                </div>
            </a>
        </div>

        <div class="col">
            <a href="{{ url('clientes/listar') }}" class="text-decoration-none">
                <div class="card bg-card border-0 h-100">
                    <div class="card-body d-flex align-items-center gap-3">
                        <i class="bi bi-people fs-1 text-white"></i>
                        <div>
                            <h6 class="mb-1 text-dark">Ver Clientes</h6>
                            <span class="badge bg-dark text-white small">Veja Seus Clientes</span>
                        </div>
                    </div>
                </div>
            </a>
        </div>
    </div>

    {% if usuario().nivel == 1 %}
    <h5 class="mb-3 mt-5 d-flex align-items-center gap-2">
        <i class="bi bi-speedometer2"></i> Administração
    </h5>
    <div class="row row-cols-1 row-cols-md-2 row-cols-xl-4 g-3">
        <div class="col">
            <a href="{{ url('admin/usuarios') }}" class="text-decoration-none">
                <div class="card bg-card border-0 h-100">
                    <div class="card-body d-flex align-items-center gap-3">
                        <i class="bi bi-speedometer2 fs-1 text-white"></i>
                        <div>
                            <h6 class="mb-1 text-dark">Dashboard Admin</h6>
                            <span class="badge bg-dark text-white small">Área Restrita</span>
                        </div>
                    </div>
                </div>
            </a>
        </div>
    </div>
    {% endif %}
</div>

<!-- Janela flutuante (Pop-up) para o mobile -->
<div id="installPrompt"
    class="fixed inset-x-0 bottom-0 bg-white p-6 rounded-t-3xl shadow-2xl transition-transform transform translate-y-full duration-500 ease-in-out md:hidden z-50">
    <div class="flex items-center justify-between mb-4">
        <div class="flex items-center">
            <img src="https://placehold.co/60x60/8B5CF6/FFFFFF?text=App" alt="Ícone do Aplicativo"
                class="w-10 h-10 rounded-xl mr-4">
            <div>
                <h3 class="text-lg font-bold text-gray-800">Baixe nosso App</h3>
                <p class="text-sm text-gray-500">Adicione à sua tela inicial para acesso rápido!</p>
            </div>
        </div>
        <button id="closePrompt" class="text-gray-400 hover:text-gray-600 focus:outline-none">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
            </svg>
        </button>
    </div>
    <button id="installButton"
        class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 px-6 rounded-full transition-colors duration-300">
        Instalar
    </button>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const installPromptElement = document.getElementById('installPrompt');
        const installButton = document.getElementById('installButton');
        const closePromptButton = document.getElementById('closePrompt');
        const showPromptButton = document.getElementById('showPromptButton');
        let deferredPrompt;

        // O evento 'beforeinstallprompt' é disparado por navegadores que suportam a instalação PWA
        window.addEventListener('beforeinstallprompt', (e) => {
            // Previne que o mini-infobar apareça automaticamente
            e.preventDefault();
            // Armazena o evento para ser usado mais tarde
            deferredPrompt = e;

            // Exibe o nosso pop-up customizado no mobile
            if (window.matchMedia('(max-width: 767px)').matches) {
                installPromptElement.classList.remove('translate-y-full');
                installPromptElement.classList.add('translate-y-0');
            } else {
                // Para o desktop, pode-se mostrar um botão diferente para testar
                showPromptButton.classList.remove('hidden');
            }
        });

        // Adiciona um evento de clique ao botão "Instalar" no nosso pop-up
        installButton.addEventListener('click', () => {
            if (deferredPrompt) {
                // Oculta nosso pop-up customizado
                installPromptElement.classList.remove('translate-y-0');
                installPromptElement.classList.add('translate-y-full');

                // Exibe o prompt de instalação do navegador
                deferredPrompt.prompt();

                // Aguarda a escolha do usuário
                deferredPrompt.userChoice.then((choiceResult) => {
                    console.log('Escolha do usuário:', choiceResult.outcome);
                    deferredPrompt = null;
                });
            }
        });

        // Adiciona um evento para fechar o pop-up
        closePromptButton.addEventListener('click', () => {
            installPromptElement.classList.remove('translate-y-0');
            installPromptElement.classList.add('translate-y-full');
        });

        // Adiciona um evento de clique ao botão de demonstração (desktop)
        showPromptButton.addEventListener('click', () => {
            if (deferredPrompt) {
                // Exibe o prompt de instalação do navegador
                deferredPrompt.prompt();

                // Aguarda a escolha do usuário
                deferredPrompt.userChoice.then((choiceResult) => {
                    console.log('Escolha do usuário:', choiceResult.outcome);
                    deferredPrompt = null;
                });
            }
        });

        // Opcional: Adiciona um listener para o evento de 'appinstalled'
        window.addEventListener('appinstalled', () => {
            console.log('O aplicativo foi instalado com sucesso!');
            // Pode-se esconder o pop-up ou mostrar uma mensagem de sucesso
            installPromptElement.classList.remove('translate-y-0');
            installPromptElement.classList.add('translate-y-full');
        });
    });
</script>

{% endblock %}